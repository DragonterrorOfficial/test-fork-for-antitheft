var PhaserSuperStorage;!function(e){var t,o;function r(e){void 0===e&&(e=""),this.namespace="",this.forcePromises=!1,this.setNamespace(e)}t=e.StorageAdapters||(e.StorageAdapters={}),Object.defineProperty(r.prototype,"length",{get:function(){return null!==this.getNameSpaceMatches()?this.getNameSpaceMatches().length:0},enumerable:!0,configurable:!0}),r.prototype.key=function(e){var t=this.getNameSpaceMatches()[e],o=this.getCookiesForNameSpace()[t]||null;return this.forcePromises?this.promisefy(o):o},r.prototype.getItem=function(e){var t=this.getCookiesForNameSpace()[e]||null;return this.forcePromises?this.promisefy(t):t},r.prototype.setItem=function(e,t){if(document.cookie=encodeURIComponent(this.namespace+e)+"="+encodeURIComponent(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/",this.forcePromises)return this.promisefy(null)},r.prototype.removeItem=function(e){if(document.cookie=encodeURIComponent(this.namespace+e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/",this.forcePromises)return this.promisefy(null)},r.prototype.clear=function(){var e=this.getCookiesForNameSpace();for(var t in e)e.hasOwnProperty(t)&&this.removeItem(t);if(this.forcePromises)return this.promisefy(null)},r.prototype.setNamespace=function(e){if(e&&(this.namespace=e+":",this.reg=new RegExp("^"+this.namespace+"[a-zA-Z0-9]*","g")),this.forcePromises)return this.promisefy(e)},r.prototype.getNameSpaceMatches=function(){var t=this;return decodeURIComponent(document.cookie).split("; ").filter(function(e){return null!==e.match(t.reg)&&0<e.match(t.reg).length})},r.prototype.getCookiesForNameSpace=function(){var o=this,r={};return this.getNameSpaceMatches().forEach(function(e){var t=e.replace(o.namespace,"").split("=");r[t[0]]=t[1]}),r},r.prototype.promisefy=function(o){return new Promise(function(e,t){e(o)})},o=r,t.CookieStorage=o}(PhaserSuperStorage=PhaserSuperStorage||{}),function(e){var t,o;function r(){this.namespace="",this.keys=[]}t=e.StorageAdapters||(e.StorageAdapters={}),Object.defineProperty(r.prototype,"forcePromises",{get:function(){return!0},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),r.prototype.key=function(e){return this.promisefy(this.keys[e])},r.prototype.getItem=function(e){var r=this;return new Promise(function(t,o){NativeStorage.getItem(r.namespace+e,function(e){t(e)},function(e){2===e.code?t(null):o(e)})})},r.prototype.setItem=function(o,r){var n=this;return o.length<1?void console.error("CordovaStorage: Key cannot be an empty string!"):new Promise(function(e,t){NativeStorage.setItem(n.namespace+o,r,function(){n.keys.indexOf(o)<0&&(n.keys.push(o),n.save()),e(null)},function(e){t(e)})})},r.prototype.removeItem=function(r){var n=this;return new Promise(function(t,o){NativeStorage.remove(n.namespace+r,function(){var e=n.keys.indexOf(r);0<=e&&(n.keys.splice(e,1),n.save()),t(null)},function(e){o(e)})})},r.prototype.clear=function(){var n=this;return new Promise(function(e,t){for(var o=0,r=0;r<n.keys.length;r++)NativeStorage.remove(n.namespace+n.keys[r],function(){++o>=n.keys.length&&(n.keys=[],n.save(),e(null))},function(e){t(e)})})},r.prototype.setNamespace=function(e){var o=this;return void 0===e&&(e=""),this.namespace=e+":",this.keys=[],new Promise(function(e,t){o.load().then(e).catch(e)})},r.prototype.promisefy=function(o){return new Promise(function(e,t){e(o)})},r.prototype.load=function(){var r=this;return new Promise(function(t,o){NativeStorage.getItem(r.namespace,function(e){r.keys=JSON.parse(e),t(null)},function(e){o(e)})})},r.prototype.save=function(){NativeStorage.setItem(this.namespace,JSON.stringify(this.keys),function(){},function(e){console.warn("CordovaStorage: Failed to save keys of namespace.")})},o=r,t.CordovaStorage=o}(PhaserSuperStorage=PhaserSuperStorage||{}),function(s){var e,t;function o(e,t){void 0===e&&(e=""),void 0===t&&(t="*"),this.namespace="",this.expectedOrigin="",this.storageLength=0,this.enabled=!1,""!==e&&this.setNamespace(e),this.expectedOrigin=t}e=s.StorageAdapters||(s.StorageAdapters={}),Object.defineProperty(o.prototype,"forcePromises",{get:function(){return!0},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return this.storageLength},enumerable:!0,configurable:!0}),o.prototype.init=function(){var e=this;return this.sendMessage({command:s.StorageCommand.init}).then(function(){e.enabled=!0})},o.prototype.key=function(e){return this.sendMessage({command:s.StorageCommand.key,value:e})},o.prototype.getItem=function(e){return this.sendMessage({command:s.StorageCommand.getItem,key:e})},o.prototype.setItem=function(e,t){return this.sendMessage({command:s.StorageCommand.setItem,key:e,value:t})},o.prototype.removeItem=function(e){return this.sendMessage({command:s.StorageCommand.removeItem,key:e})},o.prototype.clear=function(){return this.sendMessage({command:s.StorageCommand.clear})},o.prototype.setNamespace=function(e){return this.sendMessage({command:s.StorageCommand.setNamespace,value:e})},o.prototype.sendMessage=function(e){var n,a=this;e.command===s.StorageCommand.init&&(n=!1);var t=new MessageChannel;return new Promise(function(o,r){a.enabled||e.command===s.StorageCommand.init||r("Messaging not enabled!"),e.command===s.StorageCommand.init&&setTimeout(function(){n||r("Unable to get a response in time")},1e3),t.port1.onmessage=function(e){console.log("Frame received message",e);var t=s.StorageUtils.validateMessage(e.data);switch(t.command===s.StorageCommand.init&&(n=!0),void 0!==t.status&&"ok"===t.status||r(t.value),void 0!==t.length&&(a.storageLength=t.length),t.command){case s.StorageCommand.setNamespace:a.namespace=t.value+":";case s.StorageCommand.getItem:case s.StorageCommand.length:case s.StorageCommand.key:o(t.value);break;case s.StorageCommand.setItem:case s.StorageCommand.removeItem:case s.StorageCommand.clear:case s.StorageCommand.init:o(t.status);break;default:r(t.value)}},!a.enabled&&e.command!==s.StorageCommand.init||(console.log("Sending message to parent: ",e),window.parent.postMessage(e,a.expectedOrigin,[t.port2]))})},t=o,e.IframeStorage=t}(PhaserSuperStorage=PhaserSuperStorage||{}),function(r){var e,t;function o(e){void 0===e&&(e=""),this.namespace="",this.forcePromises=!1,this.setNamespace(e)}e=r.StorageAdapters||(r.StorageAdapters={}),Object.defineProperty(o.prototype,"length",{get:function(){var e=Object.keys(localStorage);return r.StorageUtils.nameSpaceKeyFilter(e,this.namespace).length},enumerable:!0,configurable:!0}),o.prototype.key=function(e){return this.forcePromises?this.promisefy(this._key,arguments):this._key(e)},o.prototype._key=function(e){var t=Object.keys(localStorage),o=r.StorageUtils.nameSpaceKeyFilter(t,this.namespace);return localStorage.getItem(o[e])},o.prototype.getItem=function(e){return this.forcePromises?this.promisefy(this._getItem,arguments):this._getItem(e)},o.prototype._getItem=function(e){return localStorage.getItem(this.namespace+e)},o.prototype.setItem=function(e,t){return this.forcePromises?this.promisefy(this._setItem,arguments):this._setItem(e,t)},o.prototype._setItem=function(e,t){return localStorage.setItem(this.namespace+e,t)},o.prototype.removeItem=function(e){return this.forcePromises?this.promisefy(this._removeItem,arguments):this._removeItem(e)},o.prototype._removeItem=function(e){return localStorage.removeItem(this.namespace+e)},o.prototype.clear=function(){return this.forcePromises?this.promisefy(this._clear,arguments):this._clear()},o.prototype._clear=function(){for(var e=Object.keys(localStorage),t=r.StorageUtils.nameSpaceKeyFilter(e,this.namespace),o=0;o<t.length;o++)localStorage.removeItem(t[o])},o.prototype.setNamespace=function(e){return this.forcePromises?this.promisefy(this._setNameSpace,arguments):this._setNameSpace(e)},o.prototype._setNameSpace=function(e){e&&(this.namespace=e+":")},o.prototype.promisefy=function(o,r){var n=this;return new Promise(function(e,t){e(o.apply(n,r))})},t=o,e.LocalStorage=t}(PhaserSuperStorage=PhaserSuperStorage||{}),function(t){var e=(o.prototype.setAdapter=function(e){this.storage=e},Object.defineProperty(o.prototype,"forcePromises",{get:function(){return this.storage.forcePromises},set:function(e){this.storage.forcePromises=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"length",{get:function(){return null===this.storage?0:this.storage.length},enumerable:!0,configurable:!0}),o.prototype.setNamespace=function(e){if(null!==this.storage)return this.storage.setNamespace(e)},o.prototype.key=function(e){return null===this.storage?"":this.storage.key(e)},o.prototype.getItem=function(e){return null===this.storage?null:this.storage.getItem(e)},o.prototype.setItem=function(e,t){if(null!==this.storage)return this.storage.setItem(e,t)},o.prototype.removeItem=function(e){if(null!==this.storage)return this.storage.removeItem(e)},o.prototype.clear=function(){if(null!==this.storage)return this.storage.clear()},o.instance=null,o);function o(e){if(void 0!==e)Object.defineProperty(e,"storage",{value:this});else{if(null!==o.instance)return o.instance;o.instance=this}t.StorageUtils.isLocalStorageSupport()?this.setAdapter(new t.StorageAdapters.LocalStorage):this.setAdapter(new t.StorageAdapters.CookieStorage)}t.StoragePlugin=e}(PhaserSuperStorage=PhaserSuperStorage||{}),void 0!==window.Phaser&&Phaser.Utils.mixinPrototype(PhaserSuperStorage.StoragePlugin,Phaser.Plugin),function(e){var t;(t=e.StorageCommand||(e.StorageCommand={}))[t.init=0]="init",t[t.setItem=1]="setItem",t[t.getItem=2]="getItem",t[t.removeItem=3]="removeItem",t[t.clear=4]="clear",t[t.setNamespace=5]="setNamespace",t[t.length=6]="length",t[t.key=7]="key",t[t.error=8]="error";var o=(e.StorageCommand,r.isLocalStorageSupport=function(){try{if("object"==typeof localStorage)return localStorage.setItem("testingLocalStorage","foo"),localStorage.removeItem("testingLocalStorage"),!0}catch(e){return!1}return!1},r.validateMessage=function(e){return e.hasOwnProperty("command")?e:null},r.nameSpaceKeyFilter=function(e,t){return e.filter(function(e){return e.substring(0,t.length)===t})},r);function r(){}e.StorageUtils=o}(PhaserSuperStorage=PhaserSuperStorage||{});